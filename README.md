# trolley_depot
## Используемый стэк
- Python
- Flask
- SQL
- HTML
- CSS

# ОПИСАНИЕ ПРЕДМЕТНОЙ ОБЛАСТИ

- Троллейбусный парк обслуживает несколько маршрутов. 
- Каждый маршрут характеризуется уникальным номером, количеством установок на маршруте, список названий остановок, датой открытия маршрута. 
- В троллейбусном парке работают профессиональные водители. О каждом водителе известны: уникальный табельный номер, Ф. И. О., дата рождения, адрес, дата приема на работу. Для уволившихся водителей проставляется также дата увольнения. 
- Менеджер троллейбусного парка составляет расписание работы водителей на маршрутах на каждый месяц. 
- В соответствии с расписанием водители выезжают на маршруты. При выезде на маршрут водитель получает от диспетчера терминал для продажи билетов. Каждый билет, проданный с помощью терминала, имеет уникальный номер. Номера первого и последнего билетов, проданных на каждой выезде, запоминаются в БД. При выдаче терминала водителю диспетчер фиксирует в БД время выезда, а по возвращении — время возвращения.

# ТЗ НА ЭТАП ПРОЕКТИРОВАНИЯ
1. Определить конечных пользователей будущей системы.
2. Для каждого пользователя составить варианты использования системы. Одними из обязательных вариантов использования должны быть пункты «Выполнение запросов к БД» и «Получение отчетов». Для реализации этих вариантов использования можно и нужно будет использовать результаты курсовой работы 4 семестра. Еще одним обязательным вариантом использования является «Авторизация»
3. Выделить основной вариант использования информационной системы (основной бизнес-процесс). 
4. Разработать систему авторизации пользователей ИС.
5. Разработать системную архитектуру ИС.
6. Для всех вариантов использования разработать главные успешные сценарии и расширения к ним.
7. Разработать системные UML-диаграммы последовательности для всех сценариев (контроллеров).
8. Разработать логическую структуру для каждого варианта использования
9. Разработать функциональные требования ко всем шаблонам.
10. Дополнить/изменить логическую модель базы данных в соответствии с дополнительными требованиями со стороны сценариев использования.
11. Построить логическую модель будущей базы данных.
12. Построить общую логическую структуру будущего приложения

# Основной вариант использования информационной системы:
Главный бизнес-процесс – составление расписания выездов на месяц
 КОНЕЧНЫЕ ПОЛЬЗОВАТЕЛИ
1.	Диспетчер – составляет расписание выездов
2.	Бухгалтерия –просматривает информацию о рейсах, на которые выходили водители 

# РАЗРАБОТКА СИСТЕМЫ АВТОРИЗАЦИИ
Тип системы авторизации - групповая. Безопасность 2-х уровневая: 
1.	Создаем три пользователя в MySQL. Один «фиктивный» - имеет доступ только к SELECT запросам к таблице с логинами и паролями, которая находится в базе данных депо. Все неавторизованные пользователи заходят через этого пользователя. После авторизации пользователь подключается под заданной ему группой
2.	В БД депо создается таблица, которая хранит логин пароль пользователя и логин пароль его группы. 

Система архитектуры:
![image](https://user-images.githubusercontent.com/48527595/170046884-25b2f242-e9a8-496a-908f-236dcc866e61.png)

# ВАРИАНТЫ ИСПОЛЬЗОВАНИЯ
##### АВТОРИЗАЦИЯ
- Уровень: Общесистемный
- Предусловие: Данные о пользователях (логин, пароль, группа) занесены в БД
- Максимальная гарантия: Авторизация в системе (занесение в сессию)
- Минимальная гарантия: Пользователь вернулся на страницу ввода логина

Главный сценарий:
1.	Пользователь начинает работу с вариантом 
2.	Приходит страница с формой для авторизации
3.	Пользователь вводит логин и пароль и отправляет форму
4.	Система  присваивает пользователю группу и отправляет в главное меню

Диаграмма последовательности:
![image](https://user-images.githubusercontent.com/48527595/170046818-b725abed-23f2-413d-829e-5bd500e555ac.png)

##### МЕНЮ ЗАПРОСОВ
- Уровень: Уровень пользователя
- Предусловие: Пользователь авторизован
- Максимальная гарантия: Получен результат конкретного запроса
- Минимальная гарантия: Пользователь вернулся в главное меню

Главный сценарий:
1.	Пользователь начинает работу с вариантом 
2.	Система присылает страницу с меню запросов
3.	Пользователь выбирает запрос
4.	Система отправляет страницу с результатом
5.	Пользователь выбрал «Вернуться»
6.	Система вернула пользователя в главное меню

Диаграмма последовательности:
![image](https://user-images.githubusercontent.com/48527595/170046782-55cc9bb0-fa1f-459c-96ea-aee9b23bc019.png)

##### СОСТАВЛЕНИЕ ОТЧЕТОВ
- Уровень: Уровень пользователя
- Предусловие: Пользователь авторизован как бухгалтер
- Максимальная гарантия: Отчет сформирован и выдан пользователю
- Минимальная гарантия: Сохранена целостность информационной системы

Главный сценарий:
1.	Пользователь начинает работу с вариантом 
2.	Система присылает страницу с вводом информации для отчета
3.	Пользователь отправил необходимые для отчета данные
4.	Система сформировала и вернула html страницу резултатов
5.	Пользователь выходит назад со страницы
6.	Система вернула пользователя в главное меню


Диаграмма последовательности:
![image](https://user-images.githubusercontent.com/48527595/170046765-ff8b7755-df27-4019-b652-5a906371d80c.png)


##### РАСПИСАНИЕ ВЫЕЗДОВ НА РЕЙС
- Уровень: Уровень пользователя
- Предусловие: Пользователь авторизован как диспетчер
- Максимальная гарантия: Расписание выездов составлено
- Минимальная гарантия: Пользователь вернулся в главное меню

Главный сценарий:
1.	Пользователь начинает работу с вариантом 
2.	Система присылает страницу с полями для ввода выезда
3.	Пользователь вводит данные выезда
4.	Система возвращает страницу со списком выездов
5.	Пользователь выбирает выезд и жмет «добавить»
6.	Система обновляет страницу с новым списком выездов
7.	Пользователь удаляет выезд из списка

8.	Система возвращает страницу с обновленным списком
9.	Пользователь нажимает «Перейти к подтверждению расписания»
10.	Система возвращает страницу с подтверждением и списком всех выездов
11.	Пользователь нажал «Подтвердить»
12.	Система вернула пользователя в главное меню

Диаграмма последовательности:
![image](https://user-images.githubusercontent.com/48527595/170046727-6ff83ecf-776f-4c8b-bcd5-f34727b83c10.png)


# СТРУКТУРА ПРОЕКТА
![image](https://user-images.githubusercontent.com/48527595/170046704-14d56eeb-1543-4a86-8c95-eeb14c0b68c0.png)

# _Итоговая логическая модель БД_
![image](https://user-images.githubusercontent.com/48527595/170046677-44488654-cc8d-4934-8de5-18164596891b.png)
